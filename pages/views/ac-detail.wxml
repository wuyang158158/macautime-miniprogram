<!--pages/views/ac-detail.wxml-->
<view class="container {{acData.isSigned?'pb220':''}}" wx:if="{{acData}}">
    <!-- 操作 -->
    <view class="nav flex" wx:if="{{source !== 'vip'}}">
        <view class="flex-1"></view>
        <button class="nav-icon flex" type="none" open-type="share">
            <image src="/images/detail/nav_icon_share_w.png" mode="aspectFill"/>
        </button>
        <view class="nav-icon" bindtap="tapLike">
            <image src="{{acData.isLike?'/images/index/nav_icon_like_pre.png':'/images/detail/nav_icon_like_w.png'}}" mode="aspectFill"/>
        </view>
        <view class="nav-icon" bindtap="tapToActivityCalendar">
            <image src="/images/detail/nav_icon_calendar_w.png" mode="aspectFill"/>
        </view>
    </view>
    <!-- bannar大图展示
        object-fit="{{direction!=='horizontal'?'cover':'contain'}}" 
    -->
    <view class="relative">
        <swiper class="bannar" bindchange="swiperHandle" current="{{current}}">
            <swiper-item wx:if="{{acData.videoUrl}}">
                <video 
                    class="bannar" 
                    id="video" 
                    src="{{acData.videoUrl}}" 
                    controls 
                    autoplay
                    enable-play-gesture 
                    poster="{{acData.videoCoverUrl}}"
                    object-fit="{{direction!=='horizontal'?'cover':'contain'}}" 
                    play-btn-position="bottom"
                    show-fullscreen-btn
                    enable-progress-gesture
                    bindplay="bindplay" 
                    bindfullscreenchange="bindfullscreenchange">
                </video>
            </swiper-item>
            <block wx:for="{{acData.bannarUrls}}" wx:key="{{index}}">
            <swiper-item data-item="{{item}}" bindtap="tapPreviewImage">
                <image src="{{item}}" class="bannar-img" mode="aspectFill"/>
            </swiper-item>
            </block>
        </swiper>
        <view class="media flex c-222222">
            <view class="f20 item mr22 {{!current?'item-ac':''}}" data-current="0" bindtap="tapMedia" wx:if="{{acData.videoUrl}}">
                <image class="video-img" src="/images/detail/icon_video_w.png" mode="aspectFill" wx:if="{{!current}}"/>
                <image class="video-img" src="/images/detail/icon_video_k.png" mode="aspectFill" wx:else/>
                <text>视频</text>
            </view>
            <view class="f20 item {{current?'item-ac':''}}" data-current="1" bindtap="tapMedia" wx:if="{{acData.videoUrl}}">图片</view>
            <view class="swiper-index f20 c-FFFFFF mr32" wx:if="{{current||!acData.videoUrl}}">{{ acData.videoUrl ?current || 1 : current + 1}}/{{acData.bannarUrls.length || 0}}</view>
        </view>
    </view>
    <!-- 内容展示 -->
    <view class="ac-page" wx:if="{{source !== 'vip'}}">
        <view class="pl32 pr32">
        <!-- 基本标题展示信息 -->
        <view class="title pb54 bd1">
            <view class="name f44 c-222222 fw6 l-h56">{{acData.activityTitle}}</view>
            <view class="flex f24">
                <view class="flex-1 flex flex-wrap">
                    <view wx:for="{{acData.activityTag}}" wx:key="{{index}}" class="tag tag-ac c-00A653 mr10">{{item}}</view>
                </view>
                <view class="f26 c-222222">{{acData.merchantName || ''}}</view>
            </view>
            <!-- <view class="mt24 flex">
                <view class="coupon f22 c-292624 flex mr16">
                    <view class="item i1 bg-F5CE93 l-h36">
                        ¥<text class="f30 fw6">50 </text>无门槛
                    </view>
                    <view class="item i2 fw5 bg-F5CE93 l-h36">可用</view>
                </view>
                <view class="coupon f22 c-292624 flex">
                    <view class="item bg-F5CE93 l-h36">
                        会员减 8 元
                    </view>
                </view>
            </view> -->
        </view>
        <!-- 参与者展示 -->
        <!-- <view class="peer flex h-156 bd1">
            <view class="flex-1 f28 c-999999">20k 人参加过</view>
            <image class="user-list user-list-ac" src="https://images.unsplash.com/photo-1551334787-21e6bd3ab135?w=48" mode="aspectFill"/>
            <image class="user-list user-list-ac" src="https://images.unsplash.com/photo-1551214012-84f95e060dee?w=48" mode="aspectFill"/>
            <image class="user-list user-list-ac" src="https://images.unsplash.com/photo-1551446591-142875a901a1?w=48" mode="aspectFill"/>
            <image class="user-list" src="/images/detail/detail_more.png" mode="aspectFill"/>
        </view> -->
        <!-- 套餐类型 -->
        <view class="combo bd1 pb45" wx:if="{{expAllMeal.length}}">
            <view class="c-title f32 c-222222 fw6 l-h55 pt32 pb32">套餐类型</view>
            <button class="flex mb16 bg-white" wx:for="{{expAllMeal}}" wx:key="{{index}}" data-mealSerial="{{item.mealSerial}}" type="none" open-type="{{userInfo?'':'getUserInfo'}}" bindtap="{{userInfo? 'tapShowMealDetail':'tapToLogin'}}">
                <view class="flex-1 c-222222 f28 ell">{{item.mealName}}</view>
                <image class="more" src="/images/index/icon_more-2.png" mode="aspectFill"/>
            </button>
        </view>
        <!-- 体验时长 -->
        <view class="ac-time h-156 bd1 flex">
            <view class="f32 c-222222 fw6 l-h55">开始时间</view>
            <view class="f28 c-222222 l-h55">{{acData.stimeStr}}</view>
        </view>
        <view class="ac-time h-156 bd1 flex">
            <view class="f32 c-222222 fw6 l-h55">结束时间</view>
            <view class="f28 c-222222 l-h55">{{acData.etimeStr}}</view>
        </view>
        <!-- 体验内容 -->
        <view class="content bd1 pb45">
            <view class="c-title f32 c-222222 fw6 l-h55 pt32 pb32">体验内容</view>
            <view class="ql-container ql-snow">
                <view class="ql-editor">
                    <!-- <rich-text nodes="{{acData.activityDetails}}"></rich-text> -->
                    <Parser html="{{acData.activityDetails}}" />
                </view>
            </view>
        </view>
        <!-- 体验评论 -->
        <view class="review bd1 pb45" wx:if="{{expComment.expCommetn.length>0}}">
            <view class="c-title f32 c-222222 fw6 l-h55 pt32 pb32">体验评论</view>
            <!-- <view class="review-tag flex f28 c-00A653 fw5">
                <view class="tag-i flex mb16">浪漫美好(25)</view>
                <view class="tag-i flex mb16">性价比高(20)</view>
                <view class="tag-i flex mb16">兑票快速(18)</view>
                <view class="tag-i flex mb16">唱歌好听(16)</view>
                <view class="tag-i-low flex mb16">排队太久(13)</view>
                <view class="tag-i flex mb16">很喜欢(12)</view>
            </view> -->
            <view class="handpick flex" wx:for="{{expComment.expCommetn}}" wx:key="{{item.commentId}}">
                <image class="photo" src="{{item.headUrl}}" mode="aspectFill"/>
                <view class="flex-1 c-222222 mb32">
                    <view class="user-name f30 l-h30">{{item.nickname || ''}}</view>
                    <view class="user-time f24 l-h30 c-999999">{{item.createDate || ''}}</view>
                    <view class="user-content clamp2 f28 l-h40">{{item.comment || ''}}</view>
                    <view class="user-activity f24 c-666666" wx:if="{{item.mealTitle}}">{{item.mealTitle}}</view>
                    <view class="weui-uploader__bd mt8">
                        <view class="weui-uploader__files" id="uploaderFiles">
                            <block wx:for="{{item.imgUrl}}" wx:key="*this" wx:for-item="imgItem">
                                <view class="weui-uploader__file" bindtap="previewImage" data-comment="{{item.id}}" id="{{imgItem.imgUrl}}">
                                    <image class="weui-uploader__img bd" src="{{imgItem.imgUrl}}" mode="aspectFill" />
                                </view>
                            </block>
                        </view>
                    </view>
                </view>
            </view>
            <view class="handpick-more f28 c-00A653" bindtap="tapToAllExpComment" wx:if="{{expComment.expCommetn.length<expComment.expCommetnCount.commentSum}}">查看全部 {{expComment.expCommetnCount.commentSum}} 条评论</view>
        </view>
        <!-- 体验地点 -->
        <view class="location bd1 pb45">
            <view class="c-title f32 c-222222 fw6 l-h55 pt32 pb32">体验地点</view>
            <view class="addr f28 c-222222">{{acData.addr}}</view>
            <view class="map mt32">
                <map
                    id="myMap"
                    class="myMap"
                    latitude="{{acData.lat}}"
                    longitude="{{acData.lng}}"
                    enable-zoom="{{false}}"
                    enable-scroll="{{false}}"
                    vslide-gesture-in-fullscreen="{{false}}"
                    markers="{{acData.markers}}"
                    show-location>
                    
                </map>
                <cover-image class="map-bg" src="/images/detail/mask_map.png" hidden="{{istrue}}" bindtap="openLocation"/>
            </view>
        </view>
        <!-- 预定须知 -->
        <view class="bd1 pb45">
            <view class="f32 c-222222 fw6 l-h55 pt32 pb32">预订须知</view>
            <view class="ql-container ql-snow">
                <view class="ql-editor">
                    <rich-text nodes="{{acData.bookings}}"></rich-text>
                </view>
            </view>
        </view>
        <!-- 使用体验 -->
        <view class="bd1 pb45">
            <view class="f32 c-222222 fw6 l-h55 pt32 pb32">使用体验</view>
            <view class="f28 c-222222 l-h30">{{acData.usage || ''}}</view>
        </view>
        <!-- 退改须知 -->
        <view class="bd1 pb45">
            <view class="f32 c-222222 fw6 l-h55 pt32 pb32">退改须知</view>
            <view class="f28 c-222222 l-h30">{{acData.returnNotice || ''}}</view>
        </view>
        </view>
        <!-- 猜你喜欢 -->
        <view class="pb45" wx:if="{{vImgUrls.length}}">
            <view class="f32 c-222222 fw6 l-h55 p32">猜你喜欢</view>
            <view class="recommend f28 c-222222">
                <swiper class="re-swiper" autoplay interval="5000" previous-margin="24rpx" next-margin="24rpx">
                <block wx:for="{{vImgUrls}}" wx:key="{{index}}">
                    <swiper-item class="re-swiper-item" data-title="{{item.activityTitle}}" data-id="{{item.experienceSerial}}" bindtap="tapToDetail">
                    <view class="slide flex ml8 mr8">
                        <image class="slide-image" src="{{item.imgUrl}}" mode="aspectFill"/>
                        <view class="flex-1 flex pl32 pr32 slide-text">
                            <view class="flex-1 f32 c-222222 fw6">{{item.activityTitle}}</view>
                            <view class="tag l-h30 c-00A653 f24">{{item.activityTag}}</view>
                        </view>
                    </view>
                    </swiper-item>
                </block>
                </swiper>
            </view>
        </view>
    </view>

    <view class="ac-page" wx:else>
        <view class="pl32 pr32">
            <!-- 基本标题展示信息 -->
            <view class="title pt40 pb40 bd1">
                <view class="f44 c-222222 fw5">水舞间门票特惠</view>
            </view>
            <!-- 体验时间 -->
            <!-- <view class="h-156 bd1 flex">
                <image src="/images/detail/icon_time.png" class="icon_time mr32" mode="aspectFill"/>
                <view class="f28 c-222222 l-h55">表演时间表</view>
                <view class="f28 c-222222 l-h55">点击查看</view>
                <image src="/images/detail/icon_more.png" class="icon_more ml16" mode="aspectFill"/>
            </view> -->
            <view class="flex h-156 bd1" bindtap="tapPreviewImage1">
                <image src="/images/detail/icon_time.png" class="icon_time mr32" mode="aspectFill"/>
                <view class="l-name f28 c-222222 fw5">表演时间表</view>
                <view class="flex-1 f28 c-222222 f-r">点击查看</view>
                <image src="/images/detail/icon_more.png" class="icon_more ml16" mode="aspectFill"/>
            </view>
            <!-- 体验地点 -->
            <view class="h-156 bd1 flex" bindtap="openLocation1">
                <image src="/images/detail/icon_address.png" class="icon_time mr32" mode="aspectFill"/>
                <view class="f28 c-222222 l-h55 fw5">澳门路氹连贯公路新濠天地</view>
            </view>
            <!-- 详情体验 -->
            <view class="ac-time bd1 flex">
                <view class="f32 c-222222 fw6 l-h55">
                    <image src="/images/detail/new_year.png" class="icon_new_year pt32" mode="aspectFill"/>
                </view>
                <view class="f28 c-222222 l-h55">
                    <view class="flex flex-alg pb32">
                        <!-- <view class="icon_time ml32 mr32">①</view> -->
                        <view class="flex-1">
                            <view class="flex mine">
                                <view class="mine-left">水舞间套餐</view>
                                <view >门市价/元</view>
                                <view >现价/元</view>
                            </view>
                            <view class="flex mine">
                                <view class="mine-left">亲子票1大1小 B区20:00场</view>
                                <view class="text-decoration">1267</view>
                                <view >1069</view>
                            </view>
                            <view class="flex mine">
                                <view class="mine-left">亲子票2大1小 B区20:00场</view>
                                <view class="text-decoration">1971</view>
                                <view >1599</view>
                            </view>
                            <view class="flex mine">
                                <view class="mine-left">成人票1张 B区20:00场</view>
                                <view class="text-decoration">704</view>
                                <view >539</view>
                            </view>
                            <view class="flex mine">
                                <view class="mine-left">成人票2张 B区20:00场</view>
                                <view class="text-decoration">1408</view>
                                <view >1069</view>
                            </view>
                        </view>
                    </view>

                    <view class="flex flex-alg pb32 f24 c-999999 l-h32">
                        <!-- <view class="icon_time ml32 mr32">②</view> -->
                        <view class="flex-1">
                            <view class="mb8">注意事项：</view>
                            <view class="mb8">* 99元加购澳门时光超值会员卡（价值99元），可享受300+商家优惠折扣，有效期一年。</view>
                            <view class="mb8">* 限量特惠补贴，预定从速， 12岁及以上需要购买成人票，请提前两天预定，下单日期第二天请查收邮箱领取电子票，不可退换，请邮箱查收电子票，如有特殊要求，请联系客服。</view>
                        </view>
                    </view>
                </view>
            </view>
            <view class="p90">
                <button class="weui-btn bay" type="primary" hover-class="hoverclass" open-type="{{userInfo?'':'getUserInfo'}}" bindtap="taptoBay">立即购买</button>
            </view>
            
            <!-- <view class="bay-fxied bg-white">
                
            </view> -->
            
        </view> 
    </view>

    <!-- 下单 -->
    <cover-view class="orders {{isIphoneX ?'fixiphonexbutton':''}}" wx:if="{{direction!=='horizontal' && acData.isSigned}}" hidden="{{istrue}}">
        <!-- 是否可购买    0：不可被购买  1：可以被购买 -->
        <cover-view class="flex" wx:if="{{acData.isBuying===0}}">
            <cover-view class="price">
                <cover-view class="sp2 mr16">有效期：{{acData.daysBetween||0}}天</cover-view>
            </cover-view>
            <button class="ordersbtn" type="primary" hover-class="hoverclass" disabled wx:if="{{acData.isBuyed||isBuyed}}">已领取</button>
            <button class="ordersbtn" type="primary" hover-class="hoverclass" open-type="{{userInfo?'':'getUserInfo'}}" bindtap="{{userInfo? 'tapGetEx':'tapToLogin'}}" wx:else>领取</button>
            
        </cover-view>
        <cover-view class="flex" wx:if="{{acData.isBuying===1}}">
            <cover-view class="price">
                <cover-view class="sp2 mr16">{{acData.symbol||'MOP$'}} {{lowestPrice ? lowestPrice : 0 }}</cover-view>
                <cover-view class="f24 c-999999 upper-price">
                    <cover-view>{{ upperPrice ? upperPrice : 0 }}</cover-view>
                    <cover-view class="text-bd"></cover-view>
                </cover-view>
            </cover-view>
            <button class="ordersbtn" type="primary" hover-class="hoverclass" disabled wx:if="{{acData.expStatus === 2}}">敬请期待</button>
            <button class="ordersbtn" type="primary" hover-class="hoverclass" open-type="{{userInfo?'':'getUserInfo'}}" bindtap="{{userInfo? 'tapToSetMeal':'tapToLogin'}}" wx:else>立即预订</button>
        </cover-view>
    </cover-view>
</view>
<!-- 详情 -->
<half-screen-dialog istrue="{{istrue}}" result="{{mealDetailResult}}" bind:closeDialog="closeDialog"></half-screen-dialog>
<gh-empty prop-type="{{noData.type}}" prop-text="{{noData.text}}" prop-mt="200" wx:if="{{noData&&!acData}}"></gh-empty>

<view class="weui-demo-dialog {{istrueBay ? 'weui-demo-dialog_show' : ''}}">
    <view class="weui-mask" bindtap="closeDialogBay"></view>
    <view class="weui-half-screen-dialog" catchtap="stopEvent">
    <view class="weui-half-screen-dialog__hd dialog-tip">
        <view class="weui-half-screen-dialog__hd__side">
        <view bindtap="closeDialogBay" class="weui-icon-btn weui-icon-btn_close">关闭</view>
        </view>
    </view>
    <view class="weui-half-screen-dialog__bd ofy-auto pb32">
       <form bindsubmit="submitBay">
       <view class="f32 fw5">水舞间</view>
            <view class="section_gap pl32 pr32 bd1 pb32">
                <view class="flex">
                    <radio-group class="radio-group" name="amount" bindchange="radioChange">
                        <radio class="radio f28" wx:for-items="{{items}}" wx:key="name" value="{{item.name}}" checked="{{item.checked}}">
                            <text class="ml16">{{item.value}}</text>
                        </radio>
                    </radio-group>
                </view>
                <view class="f24 c-999999 l-h32">
                    <view class="mb8">注意事项：</view>
                    <view class="mb8">限量特惠补贴，预定从速， 12岁及以上需要购买成人票，请提前两天预定，下单日期第二天请查收邮箱领取电子票，不可退换，请邮箱查收电子票，如有特殊要求，请联系客服。</view>
                </view>
            </view>
            <view class="flex h-122 bd1">
                <view class="l-name f32 c-222222">时光卡</view>
                <view class="flex-1 f28 c-222222 f-r">默认选择    会员卡99元</view>
            </view>
            <!-- <view class="flex h-122 bd1">
                <view class="l-name f32 c-222222">表演时间表</view>
                <view class="flex-1 f28 c-222222 f-r">点击查看</view>
                <image src="/images/detail/icon_more.png" class="icon_more ml16" mode="aspectFill"/>
            </view> -->
            <view class="flex h-122 bd1">
                <view class="l-name f32 c-222222">总价</view>
                <view class="flex-1 f28 c-222222 f-r c-00A653 fw5">{{amount}}元</view>
            </view>

            <view >
                <view class="section h-122 bd1">
                    <view class="f32 c-DA1717">*</view>
                    <view class="section__title">姓     名：</view>
                    <input name="realName" placeholder-class="input-placeholder" placeholder="需要与证件姓名一致并请携带证件" />
                </view>
                <view class="section h-122 bd1">
                    <view class="f32 c-DA1717">*</view>
                    <view class="section__title">手机号：</view>
                    <input name="phone" placeholder-class="input-placeholder" placeholder="请正确填写手机号" />
                </view>
                <view class="section h-122 bd1">
                    <view class="f32 c-DA1717">*</view>
                    <view class="section__title">E-mail：</view>
                    <input name="email" placeholder-class="input-placeholder" placeholder="请正确填写E-mail" />
                </view>
                <picker mode="date" value="{{date}}" start="{{time}}" end="2020-06-30" bindchange="bindDateChange">
                    <view class="section h-122 bd1">
                            <view class="f32 c-DA1717">*</view>
                            <view class="section__title">入场日期：</view>
                            <input name="presenceTime" placeholder-class="input-placeholder" disabled="{{true}}" placeholder="请选择入场日期" value="{{date}}"/>
                            <image src="/images/detail/icon_more.png" class="icon_more ml16" mode="aspectFill"/>
                    </view>
                </picker>
                <view class="btn-area">
                    <button class="weui-btn bay" type="primary" hover-class="hoverclass" open-type="{{userInfo?'':'getUserInfo'}}" formType="{{userInfo? 'submit':'tapToLogin'}}">下单购买</button>
                </view>
            </view>
        </form> 
        </view>
    </view>
</view>
